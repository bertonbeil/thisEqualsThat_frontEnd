GRenderer=function(){this.container;this.stats;this.program;this.gui;this.anm=true;this.anmc=true;this.sprite;this.contr;this.n2=50;this.o2=10;this.co2=1;this.camera;this.scene;this.renderer;this.group;this.particle;this.camz=400;this.direction=0;this.touchstart=false;this.currentControlCounter=3;this.cubesize=100;this.boundingCube,this.box;this.mouseX=0;this.mouseY=0;this.pg0=[];this.pg1=[];this.pg2=[];this.pg3=[];this.pg4=[];this.pg5=[];this.pg6=[];this.pg7=[];this.pg8=[];this.pg9=[];this.pg10=[];this.windowHalfX=window.innerWidth/2;this.windowHalfY=window.innerHeight/2;this.startAnimationFlag=true};GRenderer.prototype.boundingBox=function(){var a=new THREE.CubeGeometry(this.cubesize+5,this.cubesize+5,this.cubesize+5);var b=new THREE.MeshBasicMaterial({color:0,transparent:false,opacity:0.1});this.box=new THREE.Mesh(a,b);this.scene.add(this.box);this.boundingCube=new THREE.BoxHelper(this.box);this.boundingCube.material=new THREE.LineBasicMaterial({color:0,transparent:false,opacity:0.1});this.scene.add(this.boundingCube)};GRenderer.prototype.update=function(c,d,b,a){addParticles(c,Math.round(d),b,a)};GRenderer.prototype.addParticles=function(k,d,j,b){console.log("in addParticles");var g;g=this["pg"+k];console.log("store.length "+g.length);if(g.length>0){for(var c=0;c<g.length;c++){this.group.remove(g[c])}}switch(k){case 1:this.pg1=[];g=this.pg1;break;case 2:this.pg2=[];g=this.pg2;break;case 3:this.pg3=[];g=this.pg3;break;case 4:this.pg4=[];g=this.pg4;break;case 5:pg5=[];g=pg5;break;case 6:pg6=[];g=pg6;break;case 7:pg7=[];g=pg7;break;case 8:pg8=[];g=pg8;break;case 9:pg9=[];g=pg9;break;case 10:pg10=[];g=pg10;break;default:}var e=new THREE.SpriteCanvasMaterial({color:b,program:program});var f=-this.cubesize/2;if(k==0){for(var h=0;h<this.cubesize;h++){particle=new THREE.Sprite(e);particle.position.x=f;particle.position.y=0;particle.position.z=0;particle.scale.x=particle.scale.y=j;this.group.add(particle);particle=new THREE.Sprite(e);particle.position.x=0;particle.position.y=f;particle.position.z=0;particle.scale.x=particle.scale.y=j;this.group.add(particle);particle=new THREE.Sprite(e);particle.position.x=0;particle.position.y=0;particle.position.z=f;particle.scale.x=particle.scale.y=j;this.group.add(particle);f=f+1}return}for(var h=0;h<d;h++){particle=new THREE.Sprite(e);particle.position.x=Math.random()*this.cubesize-this.cubesize/2;particle.position.y=Math.random()*this.cubesize-this.cubesize/2;particle.position.z=Math.random()*this.cubesize-this.cubesize/2;particle.scale.x=particle.scale.y=j;var a={x:Math.random(),y:Math.random(),z:Math.random()};particle.velocity=a;this.group.add(particle);g.push(particle)}console.log("out addParticles")};GRenderer.prototype.init=function(a,e,d,c){this.n2=e;this.o2=d;this.co2=c;this.camera=new THREE.PerspectiveCamera(25,200/200,1,5000);this.scene=new THREE.Scene();var b=Math.PI*2;program=function(f){f.beginPath();f.arc(0,0,0.5,0,b,true);f.fill()};this.group=new THREE.Group();this.addParticles(1,this.n2,5,"#0000ff");this.addParticles(2,this.o2,5,"#00ff00");this.addParticles(3,this.co2,5,"#ff0000");this.scene.add(this.group);this.renderer=new THREE.CanvasRenderer({alpha:true});this.renderer.setPixelRatio(window.devicePixelRatio);this.renderer.setSize(200,200);a.appendChild(this.renderer.domElement);this.boundingBox()};GRenderer.prototype.startAnimation=function(){if(this.startAnimationFlag){this.render();requestAnimationFrame(this.startAnimation.bind(this))}};GRenderer.prototype.stopAnimation=function(){this.startAnimationFlag=false};GRenderer.prototype.destroy=function(){var b=this;console.log(" Destroy");this.scene.remove(this.group);for(var a=1;a<=this.currentControlCounter;a++){this.group.remove(this["pg"+a]);this["pg"+a]=[]}setTimeout(function(){b.startAnimationFlag=false;this.scene=null;this.camera=null},100)};GRenderer.prototype.render=function(){this.camera.position.z=this.camz;this.camera.lookAt(this.scene.position);if(this.touchstart){if(this.direction==1){this.camz+=10}else{this.camz-=10}}if(this.anm){this.updateVelocity()}if(this.boundingCube){this.group.rotation.x+=0.005;this.group.rotation.y+=0.005;this.box.rotation.x+=0.005;this.box.rotation.y+=0.005;this.boundingCube.rotation.x+=0.005;this.boundingCube.rotation.y+=0.005}this.renderer.render(this.scene,this.camera)};GRenderer.prototype.updateVelocity=function(){for(var c=1;c<=this.currentControlCounter;c++){var a=this["pg"+c];if(a.length>0){for(var b=0;b<a.length;b++){a[b].position.set(a[b].position.x+a[b].velocity.x,a[b].position.y+a[b].velocity.y,a[b].position.z+a[b].velocity.z);if(a[b].position.x>=this.cubesize/2){a[b].velocity.x=-a[b].velocity.x}if(a[b].position.y>=this.cubesize/2){a[b].velocity.y=-a[b].velocity.y}if(a[b].position.z>=this.cubesize/2){a[b].velocity.z=-a[b].velocity.z}if(a[b].position.x<=-this.cubesize/2){a[b].velocity.x=-a[b].velocity.x}if(a[b].position.y<=-this.cubesize/2){a[b].velocity.y=-a[b].velocity.y}if(a[b].position.z<=-this.cubesize/2){a[b].velocity.z=-a[b].velocity.z}}}}};