GRenderer=function(){this.container;this.stats;this.program;this.gui;this.anm=true;this.anmc=true;this.sprite;this.contr;this.n2=50;this.o2=10;this.co2=1;this.camera;this.scene;this.renderer;this.group;this.particle;this.camz=400;this.direction=0;this.touchstart=false;this.currentControlCounter=3;this.cubesize=100;this.boundingCube;this.mouseX=0;this.mouseY=0;this.pg0=[];this.pg1=[];this.pg2=[];this.pg3=[];this.pg4=[];this.pg5=[];this.pg6=[];this.pg7=[];this.pg8=[];this.pg9=[];this.pg10=[];this.windowHalfX=window.innerWidth/2;this.windowHalfY=window.innerHeight/2;this.startAnimationFlag=true};GRenderer.prototype.boundingBox=function(){var f=new THREE.CubeGeometry(this.cubesize,this.cubesize,this.cubesize);var d=new THREE.MeshBasicMaterial({color:13816530});var e=new THREE.Mesh(f,d);this.boundingCube=new THREE.BoxHelper(e);this.boundingCube.material=new THREE.LineBasicMaterial({color:13816530,transparent:false,opacity:1});this.scene.add(this.boundingCube)};GRenderer.prototype.update=function(h,g,e,f){addParticles(h,Math.round(g),e,f)};GRenderer.prototype.addParticles=function(i,q,l,s){console.log("in addParticles");var n;n=this["pg"+i];console.log("store.length "+n.length);if(n.length>0){for(var r=0;r<n.length;r++){this.group.remove(n[r])}}switch(i){case 1:this.pg1=[];n=this.pg1;break;case 2:this.pg2=[];n=this.pg2;break;case 3:this.pg3=[];n=this.pg3;break;case 4:this.pg4=[];n=this.pg4;break;case 5:pg5=[];n=pg5;break;case 6:pg6=[];n=pg6;break;case 7:pg7=[];n=pg7;break;case 8:pg8=[];n=pg8;break;case 9:pg9=[];n=pg9;break;case 10:pg10=[];n=pg10;break;default:}var p=new THREE.SpriteCanvasMaterial({color:s,program:program});var o=-this.cubesize/2;if(i==0){for(var m=0;m<this.cubesize;m++){particle=new THREE.Sprite(p);particle.position.x=o;particle.position.y=0;particle.position.z=0;particle.scale.x=particle.scale.y=l;this.group.add(particle);particle=new THREE.Sprite(p);particle.position.x=0;particle.position.y=o;particle.position.z=0;particle.scale.x=particle.scale.y=l;this.group.add(particle);particle=new THREE.Sprite(p);particle.position.x=0;particle.position.y=0;particle.position.z=o;particle.scale.x=particle.scale.y=l;this.group.add(particle);o=o+1}return}for(var m=0;m<q;m++){particle=new THREE.Sprite(p);particle.position.x=Math.random()*this.cubesize-this.cubesize/2;particle.position.y=Math.random()*this.cubesize-this.cubesize/2;particle.position.z=Math.random()*this.cubesize-this.cubesize/2;particle.scale.x=particle.scale.y=l;var t={x:Math.random(),y:Math.random(),z:Math.random()};particle.velocity=t;this.group.add(particle);n.push(particle)}console.log("out addParticles")};GRenderer.prototype.init=function(g,h,i,j){this.n2=h;this.o2=i;this.co2=j;this.camera=new THREE.PerspectiveCamera(25,200/200,1,5000);this.camera.position.x=this.cubesize/2;this.scene=new THREE.Scene();var f=Math.PI*2;program=function(a){a.beginPath();a.arc(0,0,0.5,0,f,true);a.fill()};this.group=new THREE.Group();this.addParticles(1,this.n2,5,"#0000ff");this.addParticles(2,this.o2,5,"#00ff00");this.addParticles(3,this.co2,5,"#ff0000");this.scene.add(this.group);this.renderer=new THREE.CanvasRenderer({alpha:true});this.renderer.setPixelRatio(window.devicePixelRatio);this.renderer.setSize(200,200);g.appendChild(this.renderer.domElement);this.boundingBox()};GRenderer.prototype.startAnimation=function(){if(this.startAnimationFlag){this.render();requestAnimationFrame(this.startAnimation.bind(this))}};GRenderer.prototype.stopAnimation=function(){this.startAnimationFlag=false};GRenderer.prototype.destroy=function(){var c=this;console.log(" Destroy");this.scene.remove(this.group);for(var d=1;d<=this.currentControlCounter;d++){this.group.remove(this["pg"+d]);this["pg"+d]=[]}setTimeout(function(){c.startAnimationFlag=false;this.scene=null;this.camera=null},100)};GRenderer.prototype.render=function(){this.camera.position.z=this.camz;this.camera.lookAt(this.scene.position);if(this.touchstart){if(this.direction==1){this.camz+=10}else{this.camz-=10}}if(this.anm){this.updateVelocity()}if(this.boundingCube){this.group.rotation.x+=0.005;this.group.rotation.y+=0.005;this.boundingCube.rotation.x+=0.005;this.boundingCube.rotation.y+=0.005}this.renderer.render(this.scene,this.camera)};GRenderer.prototype.updateVelocity=function(){for(var f=1;f<=this.currentControlCounter;f++){var e=this["pg"+f];if(e.length>0){for(var d=0;d<e.length;d++){e[d].position.set(e[d].position.x+e[d].velocity.x,e[d].position.y+e[d].velocity.y,e[d].position.z+e[d].velocity.z);if(e[d].position.x>=this.cubesize/2||e[d].position.x<=-this.cubesize/2){e[d].velocity.x=-e[d].velocity.x}if(e[d].position.y>=this.cubesize/2||e[d].position.y<=-this.cubesize/2){e[d].velocity.y=-e[d].velocity.y}if(e[d].position.z>=this.cubesize/2||e[d].position.z<=-this.cubesize/2){e[d].velocity.z=-e[d].velocity.z}}}}};